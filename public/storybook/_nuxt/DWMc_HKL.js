import{d as U,j as g,h as z,S as v,o as i,H as k,W as _,F as o,c as C,L as N,i as E,U as p,ay as I,X as R,u as s,R as W,w as y}from"./EtfM6F04.js";import{z as j,j as A,ag as B,a4 as D,t as F,a5 as L,ab as O,$ as w,k as P,x as V}from"./B3FH9UnZ.js";import{w as M}from"./BLnBc-s6.js";import{q as T}from"./C416NYd5.js";import"./D9Z9MdNV.js";import"./CqkleIqs.js";import"./Bjgmnvuu.js";import"./m9QqqGtk.js";import"./DH66uM0G.js";const q=U({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(S){const r=S,{activeWorkspaceCollections:d}=j(),{servers:m,serverMutators:c}=A(),u=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],a=g(()=>{const t=d.value.find(e=>e.uid===r.collectionId);return m[t&&typeof r.serverUid=="string"&&r.serverUid==="default"?t.servers[0]??"":t?.servers.find(e=>e===r.serverUid)??""]}),b=g(()=>{var t,e;return(t=a.value)!=null&&t.url?((e=a.value.url.match(B.PATH))==null?void 0:e.map(l=>l.slice(1,-1)))??[]:[]});z(b,t=>{if(!a.value)return;const e=a.value.variables?{...a.value.variables}:{};Object.keys(e).forEach(l=>{t.includes(l)||delete e[l]}),t.forEach(l=>{e[l]||(e[l]={default:""})}),c.edit(a.value.uid,"variables",e)},{immediate:!0});const x=(t,e)=>{!d.value||!a.value||c.edit(a.value.uid,t,e)},h=(t,e)=>{if(!a.value)return;const l=a.value.variables||{};l[t]={...l[t],default:e},c.edit(a.value.uid,"variables",l)};return(t,e)=>{var l;return i(),v("div",{class:N(["divide-0.5 flex w-full flex-col divide-y rounded-b-lg text-sm",((l=a.value)==null?void 0:l.variables)&&"bg-b-1"])},[a.value?(i(),v(_,{key:0},[o(T,{data:a.value,onUpdate:x,options:u},null,8,["data"]),a.value.variables?(i(),C(D,{key:0,variables:a.value.variables,"onUpdate:variable":h},null,8,["variables"])):k("",!0)],64)):k("",!0)],2)}}}),G={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},H={class:"flex flex-col gap-4"},X={class:"rounded-lg border"},Y={class:"bg-b-2 flex items-start justify-between rounded-t-lg py-1 pr-1 pl-3 text-sm"},J={key:1,class:"self-center"},K={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},de=U({__name:"CollectionServers",setup(S){const{activeCollection:r}=j(),{servers:d,events:m,serverMutators:c}=A(),u=F(),a=E(null),b=g(()=>{var e;return!d||!((e=r.value)!=null&&e.servers)?[]:Object.values(d).filter(l=>{var f;return(f=r.value)==null?void 0:f.servers.includes(l.uid)})}),x=()=>m.commandPalette.emit({commandName:"Add Server"}),h=()=>{var e;!((e=r.value)!=null&&e.uid)||!a.value||(c.delete(a.value,r.value.uid),u.hide())},t=e=>{a.value=e,u.show()};return(e,l)=>{var f;return i(),v("div",G,[p("div",H,[l[2]||(l[2]=I('<div class="flex items-start justify-between gap-2"><div class="flex flex-col gap-2"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(i(!0),v(_,null,R(b.value,(n,$)=>(i(),v("div",{key:n.uid},[p("div",X,[p("div",Y,[n.description?(i(),C(s(L),{key:0,value:n.description,class:"self-center"},null,8,["value"])):(i(),v("span",J,"Server "+W($+1),1)),o(s(w),{class:"hover:bg-b-3 hover:text-c-1 h-fit p-1.25",variant:"ghost",onClick:Q=>t(n.uid)},{default:y(()=>[o(s(O),{class:"size-3.5"})]),_:2},1032,["onClick"])]),s(r)?(i(),C(q,{key:0,collectionId:s(r).uid,serverUid:n.uid},null,8,["collectionId","serverUid"])):k("",!0)])]))),128)),p("div",K,[o(s(w),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:x},{default:y(()=>[o(s(P),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),l[1]||(l[1]=p("span",null,"Add Server",-1))]),_:1,__:[1]})])]),o(s(V),{size:"xxs",state:s(u),title:`Delete ${a.value?(f=s(d)[a.value])==null?void 0:f.url:"Server"}`},{default:y(()=>[o(M,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:l[0]||(l[0]=n=>s(u).hide()),onDelete:h})]),_:1},8,["state","title"])])}}});export{de as default};
